<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  1、playwright介绍 - PythonJoy
  
  </title>
 <meta name="description" content="">
 <link href="atom.xml" rel="alternate" title="PythonJoy" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />

    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
    <script src="asset/highlightjs/highlight.pack.js"></script>
    <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>hljs.initHighlightingOnLoad();</script>
    
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>

<div id="header">
    <h1><a href="index.html">PythonJoy</a></h1>
</div>

</nav>
        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; PythonJoy</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
      <li><a href="index.html">Home</a></li>
      
        <li class="divider"></li>
        <li><label>Python</label></li>

          
            <li><a title="列表生成式" href="16196181446355.html">列表生成式</a></li>
          
            <li><a title="网络编程" href="16196181446446.html">网络编程</a></li>
          
            <li><a title="面向对象 #" href="16196181446529.html">面向对象 #</a></li>
          

      
      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>

        <section id="main-content" role="main" class="scroll-container">

          <div class="row">
            <div class="large-3 medium-3 columns">
              <div class="hide-for-small">
                <div class="sidebar">
                <nav>
                  <ul id="side-nav" class="side-nav">

                    
                      <li class="side-title"><span>Python</span></li>
                        
                          <li><a title="列表生成式" href="16196181446355.html">列表生成式</a></li>
                        
                          <li><a title="网络编程" href="16196181446446.html">网络编程</a></li>
                        
                          <li><a title="面向对象 #" href="16196181446529.html">面向对象 #</a></li>
                        

                    
                  </ul>
                </nav>
                </div>
              </div>
            </div>
            <div class="large-9 medium-9 columns">

 <div class="markdown-body">
<h1>1、playwright介绍</h1>

<p><code>Playwright</code>是一个强大的Python库，仅用一个API即可自动执行<code>Chromium</code>、<code>Firefox</code>、<code>WebKit</code>等主流浏览器自动化操作，并同时支持以无头模式、有头模式运行。</p>

<p>从安装到第一次录制脚本，给我感觉优点是安装简单快速，脚本录制可靠，功能强大简洁，缺点是新出来的工具，没有api文档，使用教程和相关文档比较少，可以当一当吃螃蟹的人了。</p>

<h1 id="toc_0">2、playwright使用</h1>

<h2 id="toc_1">安装</h2>

<pre><code class="language-text"># 安装playwright依赖库，需要python3.7
pip install playwright

# 安装浏览器驱动文件（chromium、firefox、webkit）
python -m playwright install
</code></pre>

<h2 id="toc_2">录制</h2>

<p>使用<code>Playwright</code>无需写一行代码，我们只需手动操作浏览器，它会录制我们的操作，然后自动生成代码脚本。</p>

<p>录制命令codegen，打开chrome无头模式开始脚本录制</p>

<pre><code class="language-text"># 命令行键入
python -m playwright codegen
</code></pre>

<p><code>codegen</code>的用法可以使用<code>--help</code>查看，如果有其他需要可以添加<code>options</code>。</p>

<pre><code class="language-python3">python -m playwright codegen --help
Usage: index codegen [options] [url]

open page and generate code for user actions

Options:
  -o, --output &lt;file name&gt;  saves the generated script to a file
  --target &lt;language&gt;       language to use, one of javascript, python, python-async, csharp (default: &quot;python&quot;)
  -h, --help                display help for command

Examples:

  $ codegen
  $ codegen --target=python
  $ -b webkit codegen https://example.com
</code></pre>

<p>options含义：</p>

<ul>
<li><p>-o：将录制的脚本保存到一个文件</p></li>
<li><p>--target：规定生成脚本的语言，有<code>JS</code>和<code>Python</code>两种，默认为Python</p></li>
<li><p>-b：指定浏览器驱动，浏览器选项如下（缺省默认为chromium）</p>
<pre><code class="language-undefined">cr 谷歌浏览器，或全称chromium
ff 火狐浏览器，或全称firefox<br/>
wk 全称webkit
</code></pre></li>
</ul>

<p>例如用chromium打开京东录制操作并存储到my.py文件中，文件存储在执行命令的目录下</p>

<pre><code class="language-csharp">python -m playwright codegen -o my.py -b https://jd.com
</code></pre>

<h2 id="toc_3">其他操作</h2>

<p>--save-storage与--load-storage是个非常实用的命令</p>

<p>用下面命令访问网站并登陆，关闭浏览器时自动把cookie等浏览器信息存入jd文件中</p>

<pre><code class="language-cpp">python -m playwright cr https://jd.com --save-storage jd
</code></pre>

<p>使用时用下述命令直接调用，打开页面即为上次登陆状态</p>

<pre><code class="language-cpp">python -m playwright cr https://jd.com --load-storage jd
</code></pre>

<p>假如我有多个网站帐号就可以存在多个不同文件，使用时输入命令即可，文件默认储存在当前执行命令的目录</p>

<p>在网站录制操作的过程中也可以用--save，例如：</p>

<pre><code class="language-csharp">python -m playwright codegen --target python -o login.py https://jd.com --save-storage jd
</code></pre>

<p>这样py代码中也生成了保存信息到本地的功能代码，适合于更新帐号信息，然后录制操作只用录制登陆后的页面即可，如下命令，直接读取已登陆的状态，然后就能在已登陆状态下录制：</p>

<pre><code class="language-csharp">python -m playwright codegen -o run.py https://jd.com --load-storage jd
</code></pre>

<h2 id="toc_4">执行</h2>

<p>很简单，直接执行py文件</p>

<pre><code class="language-text">python run.py
</code></pre>

<h3 id="toc_5">开源地址</h3>

<p><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fplaywright">https://github.com/microsoft/playwright</a><br/>
<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fplaywright-python">https://github.com/microsoft/playwright-python</a></p>


</div>

<br /><br />
<hr />

<div class="row clearfix">
  <div class="large-6 columns">
	<div class="text-left" style="padding:15px 0px;">
		
	        <a href="16196181446693.html"  title="Previous Post: pip安装时报错问题记录">&laquo; pip安装时报错问题记录</a>
	    
	</div>
  </div>
  <div class="large-6 columns">
	<div class="text-right" style="padding:15px 0px;">
		
	        <a href="16196181446773.html" 
	        title="Next Post: 爬取数据、数据存储等设计思路与cnbeta整体相似，不同之处主要有以下几点：">爬取数据、数据存储等设计思路与cnbeta整体相似，不同之处主要有以下几点： &raquo;</a>
	    
	</div>
  </div>
</div>

<div class="row">
<div style="padding:0px 0.93em;" class="share-comments">

</div>
</div>
<script type="text/javascript">
	$(function(){
		var currentURL = '16196181446731.html';
		$('#side-nav a').each(function(){
			if($(this).attr('href') == currentURL){
				$(this).parent().addClass('active');
			}
		});
	});
</script>  
</div></div>


<div class="page-bottom">
  <div class="row">
  <hr />
  <div class="small-9 columns">
  <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
  <div class="small-3 columns">
  <p class="copyright text-right"><a href="#header">TOP</a></p>
  </div>
   
  </div>
</div>

        </section>
      </div>
    </div>
    
    
    <script src="asset/js/foundation.min.js"></script>
    <script src="asset/js/foundation/foundation.offcanvas.js"></script>
    <script>
      $(document).foundation();

     
    </script>
    


  </body>
</html>
