# 网络编程

## 基于传输层协议的套接字编程

套接字（socket）

应用层通过传输层进行数据通信时，TCP和UDP会遇到同时为多个应用程序进程提供并发服务的问题。多个TCP连接或多个应用程序进程可能需要通过同一个TCP协议端口传输数据。**为了区别不同的应用程序进程和连接**，许多计算机操作系统为应用程序与TCP／IP协议交互提供了称为套接字 (Socket)的接口，区分不同应用程序进程间的网络通信和连接。

生成套接字，主要有3个参数：通信的目的IP地址、使用的传输层协议(TCP或UDP)和使用的端口号

### **实战1：发送邮件**

在自动化测试中常用场景，执行完用例后自动发邮件，这里可以用到Python的smtplib库，它对smtp协议进行了简单的封装。

SMTP（Simple Mail Transfer Protocol）即简单邮件传输协议,它是一组用于由源地址到目的地址传送邮件的规则，由它来控制信件的中转方式。

#### Python SMTP发送邮件

创建SMTP对象

```python
import smtplib

smtpObj = smtplib.SMTP( [host [, port [, local_hostname]]] )
```

SMTP对象中sendmail方法用例发送邮件

```python
SMTP.sendmail(from_addr, to_addrs, msg[, mail_options, rcpt_options])
# 示例
smtper.sendmail(sender, receivers, message.as_string())
```

- from_addr: 邮件发送者地址。
- to_addrs: 字符串列表，邮件发送地址。
- msg: 发送消息，msg 是字符串，表示邮件内容，所以通常要处理成string类型

#### 发送纯文本邮件

创建MIMEText邮件主题对象

```
message = MIMEText(content, _subtype, 'utf-8')
```

content：文本内容，必须是字符串

_subtype：文本类型默认为'plain'，html格式类型为'html'

内容编码：中文默认utf-8