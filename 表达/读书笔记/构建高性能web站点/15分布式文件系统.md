### 复制与分离

**主从复制**

MySQL的主从复制是依据主服务器的二进制日志进行的，主服务器开启二进制日志，它会自动记录所有对数据库产生更新的操作。

这种复制是异步的，从服务器定时向主服务器请求最新日志，复制过程对于主服务器的影响是有限的。

**读写分离**

我们知道数据库会将数据从主服务器复制到多台服务器上，在多台从服务器上的更新操作，必须要作用于主服务器上，才能保证所有数据库服务器上的数据一致。

为此，采用读写分离的方法，将程序中对数据库的写操作指向主服务器，将读操作指向从服务器。

但读操作需要去哪台从服务器上读取，程序没有很好的机制均衡分配，更重要的如果从服务器发生故障，应用程序并不知道。

方案：使用数据库反向代理

例如MySQL可以使用MySQL Proxy，它工作在应用程序和MySQL服务器之间，负责所有请求的响应和响应数据转发。

应用程序只需要跟MySQL Proxy通信，读写分离的工作都交给MySQL Proxy来处理，MySQL Proxy还对多个从服务器实现负载均衡以及可用性检测。

**垂直分区**

对于数据库写频繁的站点来说，主服务器花费大部分时间在写数据，那么从服务器也将花费更多时间来同步数据。这时增加从服务器获得的回报将变少，呈现边际效益递减。

可以将主服务器也进行分离，将关联性较低的业务数据放在不同的服务器上。再通过主从复制对分离出去的服务器进行读写分离。

**水平分区**

将同一数据表中的记录通过特定的算法进行分离，分别保存在不同的数据表中，从而可以部署在不同的数据库服务器上。

例如按照id奇偶性质来划分，存储到不同数据库服务器上。
